generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "sqlite"
}

model User {
  id         String    @id
  email      String    @unique
  name       String
  syllabusId Int?
  syllabus   Syllabus? @relation(fields: [syllabusId], references: [id])

  progress UserChapterProgress[]
}

model Syllabus {
  id       Int        @id @default(autoincrement())
  name     String     @unique
  Subjects Subjects[]
  users    User[]
}

model Subjects {
  id         Int       @id @default(autoincrement())
  name       String
  SyllabusId Int
  icon        String?
  Topic      Chapter[]
  Syllabus   Syllabus  @relation(fields: [SyllabusId], references: [id])
}

model Chapter {
  id        Int                   @id @default(autoincrement())
  name      String
  SubjectId Int
  Subjects  Subjects              @relation(fields: [SubjectId], references: [id])
  notes     Notes[]
  quiz      Quiz[]
  topic     Topic[]
  progress  UserChapterProgress[]
}

model Notes {
  id        Int      @id @default(autoincrement())
  name      String
  link      String
  Author    String
  Date      DateTime
  ChapterId Int
  Chapter   Chapter  @relation(fields: [ChapterId], references: [id])
}

model Quiz {
  id        Int          @id @default(autoincrement())
  name      String
  ChapterId Int
  QandA     QandA_quiz[]
  Chapter   Chapter      @relation(fields: [ChapterId], references: [id])
}

model QandA_quiz {
  id       Int    @id @default(autoincrement())
  Question String
  Option1  String
  Option2  String
  Option3  String
  Option4  String
  Answer   String
  QuizId   Int
  Quiz     Quiz   @relation(fields: [QuizId], references: [id])
}

model Topic {
  id        Int     @id @default(autoincrement())
  name      String
  ChapterId Int
  QandA     QandA[]
  Chapter   Chapter @relation(fields: [ChapterId], references: [id])
}

model QandA {
  id       Int    @id @default(autoincrement())
  Question String
  Option1  String
  Option2  String
  Option3  String
  Option4  String
  Answer   String
  TopicId  Int
  Topic    Topic  @relation(fields: [TopicId], references: [id])
}

model UserChapterProgress {
  id        Int    @id @default(autoincrement())
  userId    String
  chapterId Int

  scorePercent    Float?
  progressPercent Float?
  completed       Boolean  @default(false)
  lastStudiedAt   DateTime @default(now())

  user    User    @relation(fields: [userId], references: [id])
  chapter Chapter @relation(fields: [chapterId], references: [id])

  @@unique([userId, chapterId])
}
